## OKX Option Data (Memory-Mapped Files)

### Summary

This document describes the format and content of memory-mapped files generated by the `Cryptodd` software for storing OKX option data.  
The files are designed for efficient access and analysis of large datasets.

### Format

* **Memory-mapped:** Data is stored in a memory-mapped NumPy array for efficient access.
* **Data Type:** Double-precision floating-point numbers (`np.float64`).
* **File Naming Pattern:** `/okx/option/<instrument>/<first_timestamp_ms>.mm`
    * `<instrument>`: Underlying asset symbol (e.g., BTC-USD, ETH-USD)
    * `<first_timestamp_ms>`: Timestamp of the first data point in milliseconds

### Data Structure

The data is organized into a 3-dimensional matrix with the following shape:

* **(-1, 32, 25)**
    * **-1**: Variable length dimension, determined by the number of snapshots.
    * **32**: Number of options per snapshot.
    * **25**: Number of data points per option.

### Data Selection
Top-K selection algorithm to select the top 32 options based on open interest and volume

### Data Columns

| Index | Name               | Description                                                  |
|-------|--------------------|--------------------------------------------------------------|
| 0     | Timestamp           | Raw timestamp in milliseconds                               |
| 1     | ExpiryTimeDiff      | Milliseconds remaining until option expiry (always positive) |
| 2     | Delta               | Option price sensitivity to underlying asset price change     |
| 3     | Gamma               | Sensitivity of Delta to underlying asset price change         |
| 4     | Vega                | Option price sensitivity to implied volatility change          |
| 5     | Theta               | Option price decay due to time decay (always negative)       |
| 6     | DeltaBs              | Delta value calculated using the Black-Scholes model (optional) |
| 7     | GammaBs              | Gamma value calculated using the Black-Scholes model (optional) |
| 8     | VegaBs               | Vega value calculated using the Black-Scholes model (optional) |
| 9     | ThetaBs              | Theta value calculated using the Black-Scholes model (optional) |
| 10    | Lever               | Leverage associated with the option contract                  |
| 11    | MarkVol              | Option's mark volatility                                      |
| 12    | BidVol               | Best bid volume                                             |
| 13    | AskVol               | Best ask volume                                             |
| 14    | ForwardPrice         | Option's forward price                                         |
| 15    | OpenInterest         | Open interest for the option contract, adjusted for ctVal     |
| 16    | SpreadPercent        | Percentage spread between best ask and bid prices            |
| 17    | SpreadToMarkPercent   | Percentage spread between option forward price and underlying asset's current price |
| 18    | Change24HPercent     | Option price change compared to 24 hours ago (always positive) |
| 19    | ChangeTodayPercent    | Option price change compared to start of day UTC (always positive) |
| 20    | ChangeTodayChinaPercent | Option price change compared to start of day China time (always positive) |
| 21    | Volume24H            | Option's total trading volume in the last 24 hours           |
| 22    | PriceRatio24H         | Ratio of current price to daily range (low to high)           |
| 23    | LastPrice            | Last traded price                                            |
| 24    | Price                | Final option price used (last traded or ask-bid midpoint)     |

### Notes

* When the spread between the best ask and bid prices is very small, the mid-price is used as the final `Price`.
* `OpenInterest` is adjusted based on the option's `ctVal` to represent the notional value of outstanding contracts.
* Suffixes "Bs" in some columns indicate values calculated using the Black-Scholes model.

### Determining Option Type

The `Delta` value can be used to identify the option type:

* **Positive Delta:** Call Option
* **Negative Delta:** Put Option

### Option Greeks Explained

The columns `Delta`, `Gamma`, `Vega`, and `Theta` represent the option's sensitivity to various factors:

* **Delta:** Measures the change in option price for a one-unit change in the underlying asset price.
* **Gamma:** Measures the rate of change of Delta with respect to the underlying asset price.
* **Vega:** Measures the change in option price for a one-unit change in implied volatility.
* **Theta:** Measures the time decay of the option's value.